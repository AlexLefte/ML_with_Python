{"cells":[{"cell_type":"markdown","source":["# Random Forest Algorithm on Splice Genes Dataset\n"],"metadata":{"id":"h9AsBJ92id2j"}},{"cell_type":"markdown","source":["This project is supposed to predict whether a specific ARN nucleotides sequence is an **exon/intron/NA**.\n","\n","In order to do so, I tried to implement 3 different types of algorithms: **random forest**, **support vector machine** and finally a **neural network**.\n","\n","The objective is to determine which of these is better in this context and what **parameters** are to be modified in order to achieve the best accuracy for our model."],"metadata":{"id":"KLF_tf4tilpU"}},{"cell_type":"markdown","source":["# Imports (libraries and classes)\n"],"metadata":{"id":"PreMtUhIjisI"}},{"cell_type":"code","source":["import numpy as np\n","from sklearn import datasets, ensemble\n","from sklearn.model_selection import train_test_split\n","from sklearn.preprocessing import OrdinalEncoder\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.metrics import classification_report\n","from sklearn.metrics import confusion_matrix\n","\n","label_encoder = LabelEncoder()\n","ordinal_encoder = OrdinalEncoder()"],"metadata":{"id":"ygYDarthjmPY","executionInfo":{"status":"ok","timestamp":1650227193830,"user_tz":-180,"elapsed":655,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":8,"outputs":[]},{"cell_type":"markdown","source":["# Dataset\n"],"metadata":{"id":"josneRjbjvIW"}},{"cell_type":"code","source":["# Funtion which returnes 'True' if the two lists have any elements in common\n","# It returnes 'False' if there are NO elements in common\n","def common_elements(s1, s2): \n","    if s1 & s2:\n","        return True\n","    return False"],"metadata":{"id":"KNPm1EKSllE7","executionInfo":{"status":"ok","timestamp":1650227128813,"user_tz":-180,"elapsed":3,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["data = np.genfromtxt('splice.data',dtype=None, encoding=None,delimiter=',')  # Importing our data \n","data = data[:,[0,2]]      # Reassigning data with only the first and third column\n","a = {'D','N','S','R'}   # Creating a set of ambiguous characters\n","index = []              # Creating a list to which we will append the unwanted rows indexes\n","\n","for i in range(data.shape[0]):\n","    temp = set(data[i][1].strip());             # Assigning the DNA sequence as a set\n","    if common_elements(temp, a) != False:       # Check whether there are any common elements between these sets                     \n","        index.append(i)                         # If so, append the index of the row to be deleted\n","\n","data = np.delete(data, index, 0)                # Delete the rows we don't need"],"metadata":{"id":"TONvMshWlRQz","executionInfo":{"status":"ok","timestamp":1650227165118,"user_tz":-180,"elapsed":251,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":5,"outputs":[]},{"cell_type":"markdown","source":["# Creating our train/test sets"],"metadata":{"id":"5mX0AxeqyPxU"}},{"cell_type":"code","source":["# Creating our features/labels arrays\n","X = np.array(data[:,1:])              # Features array\n","Y = np.array(data[:,:1])              # Labels array\n","\n","X = ordinal_encoder.fit_transform(X)          #Encoding our attribtes (A -> 0, C -> 2, G -> 3, T -> 4)\n","Y = label_encoder.fit_transform(Y.ravel())    #Encoding our labels (EI -> 0, IE -> 1, N -> 2)\n","\n","X_train, X_test, Y_train, Y_test = train_test_split(X, Y, train_size=0.75, test_size=0.25)  # We are going to use a 75 / 25 split (70 / 30 is also ok)"],"metadata":{"id":"Cr7N5DXiyTzw","executionInfo":{"status":"ok","timestamp":1650227170158,"user_tz":-180,"elapsed":286,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":6,"outputs":[]},{"cell_type":"markdown","source":["# Creating and also testing our classifier for different values of the cost"],"metadata":{"id":"SvYSh0OFzCb2"}},{"cell_type":"code","source":["nr_arbori = np.arange(2, 10, 2)\n","in_bag = np.arange(0.05,1.05,0.05)\n","nr_trasaturi = np.arange(0.05,1.05,0.05)\n","\n","# for i in nr_arbori:\n","#     for j in in_bag:\n","#         for k in nr_trasaturi:\n","#             clf=ensemble.BaggingClassifier(max_features=k,n_estimators=i,max_samples=j).fit(X_train,Y_train)\n","#             #clf=ensemble.BaggingClassifier(n_estimators=i,max_samples=j).fit(X_train,Y_train)\n","#             pred=clf.predict(X_test)\n","#             count=0\n","#             for k in range(len(pred)):\n","#                 if(pred[k]==Y_test[k]):\n","#                     count+=1\n","#             print(\"Acuratetea pentru un numar de arbori: \" + str(i) + \" un procent in-bag: \" + str(j) + \" este: \"+str(count/len(pred)) + \"\\n\")\n","              \n","for i in nr_arbori:\n","    for j in in_bag:\n","            clf = ensemble.BaggingClassifier(n_estimators=i,max_samples=j).fit(X_train,Y_train)\n","            pred = clf.predict(X_test)\n","            count = 0\n","            for k in range(len(pred)):\n","                if(pred[k] == Y_test[k]):\n","                    count += 1\n","            print(\"Acuratetea pentru un numar de arbori: \" + str(i) + \" un procent in-bag: \" + str(j) + \" este: \"+str(count/len(pred)) + \"\\n\")"],"metadata":{"id":"k3HgUzvlzE1j","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650227506201,"user_tz":-180,"elapsed":1528,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}},"outputId":"c64d85ae-682d-47a3-fb0f-45135a7b60b1"},"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.05 este: 0.7707808564231738\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.1 este: 0.7594458438287154\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.15000000000000002 este: 0.7619647355163728\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.2 este: 0.7594458438287154\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.25 este: 0.7846347607052897\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.3 este: 0.7644836272040302\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.35000000000000003 este: 0.760705289672544\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.4 este: 0.7682619647355163\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.45 este: 0.7720403022670025\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.5 este: 0.77455919395466\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.55 este: 0.7783375314861462\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.6000000000000001 este: 0.7808564231738035\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.6500000000000001 este: 0.7707808564231738\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.7000000000000001 este: 0.7695214105793451\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.7500000000000001 este: 0.7732997481108312\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.8 este: 0.7846347607052897\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.8500000000000001 este: 0.7770780856423174\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.9000000000000001 este: 0.7884130982367759\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 0.9500000000000001 este: 0.7783375314861462\n","\n","Acuratetea pentru un numar de arbori: 2 un procent in-bag: 1.0 este: 0.7884130982367759\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.05 este: 0.8249370277078085\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.1 este: 0.7720403022670025\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.15000000000000002 este: 0.7984886649874056\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.2 este: 0.7846347607052897\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.25 este: 0.8073047858942065\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.3 este: 0.7959697732997482\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.35000000000000003 este: 0.7846347607052897\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.4 este: 0.8022670025188917\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.45 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.5 este: 0.7934508816120907\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.55 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.6000000000000001 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.6500000000000001 este: 0.792191435768262\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.7000000000000001 este: 0.783375314861461\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.7500000000000001 este: 0.77455919395466\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.8 este: 0.7871536523929471\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.8500000000000001 este: 0.7858942065491183\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.9000000000000001 este: 0.7871536523929471\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 0.9500000000000001 este: 0.7972292191435768\n","\n","Acuratetea pentru un numar de arbori: 4 un procent in-bag: 1.0 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.05 este: 0.8035264483627204\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.1 este: 0.7934508816120907\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.15000000000000002 este: 0.8148614609571788\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.2 este: 0.8173803526448362\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.25 este: 0.7984886649874056\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.3 este: 0.8110831234256927\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.35000000000000003 este: 0.7871536523929471\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.4 este: 0.8047858942065491\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.45 este: 0.7959697732997482\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.5 este: 0.8035264483627204\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.55 este: 0.801007556675063\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.6000000000000001 este: 0.8035264483627204\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.6500000000000001 este: 0.7984886649874056\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.7000000000000001 este: 0.7972292191435768\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.7500000000000001 este: 0.7984886649874056\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.8 este: 0.7884130982367759\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.8500000000000001 este: 0.7858942065491183\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.9000000000000001 este: 0.792191435768262\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 0.9500000000000001 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 6 un procent in-bag: 1.0 este: 0.7959697732997482\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.05 este: 0.7972292191435768\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.1 este: 0.8261964735516373\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.15000000000000002 este: 0.8287153652392947\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.2 este: 0.8211586901763224\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.25 este: 0.8123425692695214\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.3 este: 0.8073047858942065\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.35000000000000003 este: 0.8110831234256927\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.4 este: 0.8085642317380353\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.45 este: 0.809823677581864\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.5 este: 0.8073047858942065\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.55 este: 0.7896725440806045\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.6000000000000001 este: 0.7934508816120907\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.6500000000000001 este: 0.801007556675063\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.7000000000000001 este: 0.7846347607052897\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.7500000000000001 este: 0.7909319899244333\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.8 este: 0.7884130982367759\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.8500000000000001 este: 0.7858942065491183\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.9000000000000001 este: 0.7896725440806045\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 0.9500000000000001 este: 0.7858942065491183\n","\n","Acuratetea pentru un numar de arbori: 8 un procent in-bag: 1.0 este: 0.7808564231738035\n","\n"]}]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Splice_genes_RF","provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1650188976442}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}