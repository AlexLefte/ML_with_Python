{"cells":[{"cell_type":"markdown","source":["**HIDDEN MARKOV MODELS**\n","\n","\n","Vom incerca prin acest algoritm sa realizam prognoza meteo a zilei ulterior, date fiind observatiile referitoare la ziua respectiva"],"metadata":{"id":"BEyiKclRi0RD"}},{"cell_type":"markdown","source":["# IMPORT & SETUP"],"metadata":{"id":"XW05QlIBjJPQ"}},{"cell_type":"code","source":["%tensorflow_version 2.x"],"metadata":{"id":"wlJQv4HUjHYK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!pip install tensorflow_probability==0.8.0rc0 --user --upgrade"],"metadata":{"id":"jS-VJvzqulQ-","executionInfo":{"status":"ok","timestamp":1650226238604,"user_tz":-180,"elapsed":5487,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}},"outputId":"caf77185-2ab9-4af3-a1ac-3d1e79d2ef0d","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting tensorflow_probability==0.8.0rc0\n","  Downloading tensorflow_probability-0.8.0rc0-py2.py3-none-any.whl (2.5 MB)\n","\u001b[K     |████████████████████████████████| 2.5 MB 13.6 MB/s \n","\u001b[?25hCollecting cloudpickle==1.1.1\n","  Downloading cloudpickle-1.1.1-py2.py3-none-any.whl (17 kB)\n","Requirement already satisfied: six>=1.10.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow_probability==0.8.0rc0) (1.15.0)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from tensorflow_probability==0.8.0rc0) (4.4.2)\n","Requirement already satisfied: numpy>=1.13.3 in /usr/local/lib/python3.7/dist-packages (from tensorflow_probability==0.8.0rc0) (1.21.5)\n","Installing collected packages: cloudpickle, tensorflow-probability\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","gym 0.17.3 requires cloudpickle<1.7.0,>=1.2.0, but you have cloudpickle 1.1.1 which is incompatible.\u001b[0m\n","Successfully installed cloudpickle-1.1.1 tensorflow-probability-0.8.0rc0\n"]}]},{"cell_type":"code","source":["import tensorflow_probability as tfp\n","import tensorflow as tf"],"metadata":{"id":"rWB4PvpCubyN","executionInfo":{"status":"ok","timestamp":1650226252963,"user_tz":-180,"elapsed":4019,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":2,"outputs":[]},{"cell_type":"markdown","source":["Modelul va face predictii in baza unui sistem simplu:\n","\n","\n","1.   Zilele racoroase sunt marcate cu \"0\", iar cele calde cu \"1\"\n","2.   Prima zi din secventa noastra are sanse de 80% de a fi zi racoroasa\n","3.   O zi rece are 30% sanse de a fi urmata de o zi calduroasa\n","4.   O zi calduroasa are sansa de 20% de a fi urmata de o zi rece\n","5.   In fiecare zi temperatura este distribuita cu o medie de 0 si o deviatie standard de 5 (zi racoroasa), respectiv o medie de 15 si o deviatie standard de 10 (zi calduroasa)\n"],"metadata":{"id":"U7aLKzaIoZxM"}},{"cell_type":"markdown","source":["# CREAREA MODELULUI"],"metadata":{"id":"-T89lgjdrRX9"}},{"cell_type":"code","source":["tfd = tfp.distributions\n","\n","initial_distribution = tfd.Categorical(probs=[0.8, 0.2])  # indeplinim punctul 2\n","transition_distribution = tfd.Categorical(probs=[[0.7, 0.3],\n","                                          [0.8, 0.2]])  # conditiile 3 si 4\n","observation_distribution = tfd.Normal(loc=[0., 15.], scale=[5., 10.])  # indeplinire conditie 5\n","\n","# loc = reprezinta media fiecarui tip de zi (calduroasa/racoroasa), iar scale reprezinta deviatia standard"],"metadata":{"id":"a1THfv1Oppvz","executionInfo":{"status":"ok","timestamp":1650226257326,"user_tz":-180,"elapsed":1252,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["model = tfd.HiddenMarkovModel(\n","    initial_distribution,\n","    transition_distribution,\n","    observation_distribution,\n","    num_steps=7  # Numarul de zile pentru care dorim sa facem prognoza\n",")\n","\n","\n","mean = model.mean()\n","# Afisarea prognozei temperaturilor pentru cele 7 zile dorite:\n","with tf.compat.v1.Session() as sess:\n","    print(mean.numpy())"],"metadata":{"id":"Y1283SrdrZdh","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650226262205,"user_tz":-180,"elapsed":365,"user":{"displayName":"Alex Lefterache","userId":"15058845770182448453"}},"outputId":"3dfaee6e-6174-4abd-b8f4-4f179328376e"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["[2.9999998 4.2       4.08      4.0919995 4.0907993 4.090919  4.090907 ]\n"]}]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Hidden_Markov_Model_Weather_Prediction","provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1648341832672}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}